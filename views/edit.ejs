<% layout("/layout/boilerplate")-%>
<body>
    <div class="container" style="margin-top: 5px;">
        <!-- Assuming `vehicle` is passed from the backend with current details -->
        <form action="/listing/<%= vehicle._id %>?_method=PUT" method="POST" novalidate class="needs-validation" enctype="multipart/form-data">
            <div class="row mt-3">
                <div class="col-8 offset-2">
                    <h5>Edit Rental Vehicle</h5>

                    <!-- Vehicle Type -->
                    <div class="mb-3">
                        <label for="type" class="form-label">Type (Car/Bike):</label>
                        <select name="type" id="type" required class="form-control">
                            <option value="Car" <%= vehicle.type === 'Car' ? 'selected' : '' %>>Car</option>
                            <option value="Bike" <%= vehicle.type === 'Bike' ? 'selected' : '' %>>Bike</option>
                        </select>
                    </div>

                    <!-- Brand -->
                    <div class="mb-3">
                        <label for="brand" class="form-label">Brand:</label>
                        <input type="text" id="brand" name="brand" value="<%= vehicle.brand %>" required class="form-control">
                        <div class="invalid-feedback">Please provide the vehicle brand.</div>
                    </div>

                    <!-- Model -->
                    <div class="mb-3">
                        <label for="model" class="form-label">Model:</label>
                        <input type="text" id="model" name="model" value="<%= vehicle.model %>" required class="form-control">
                        <div class="invalid-feedback">Please provide the vehicle model.</div>
                    </div>

                    <!-- Year -->
                    <div class="mb-3">
                        <label for="year" class="form-label">Year:</label>
                        <input type="number" id="year" name="year" value="<%= vehicle.year %>" min="2000" max="2024" required class="form-control">
                        <div class="invalid-feedback">Please provide a valid year.</div>
                    </div>

                    <!-- Description -->
                    <div class="mb-3">
                        <label for="description" class="form-label">Description:</label>
                        <textarea id="description" name="description" rows="3" required class="form-control"><%= vehicle.description %></textarea>
                        <div class="invalid-feedback">Please provide a valid description.</div>
                    </div>

                    <!-- Display Current Image -->
                    <div class="mb-3 text-center">
                        <label class="form-label">Current Image:</label>
                        <div class="d-flex justify-content-center">
                            <img src="<%= vehicle.image.url %>" alt="Vehicle Image" class="img-thumbnail" style="max-width: 300px; height: auto;">
                        </div>
                    </div>

                    <!-- Image Upload -->
                    <div class="mb-3">
                        <label for="image" class="form-label">Upload New Image:</label>
                        <input type="file" id="image" name="image" class="form-control">
                        <div class="invalid-feedback">Please upload a valid image.</div>
                    </div>

                    <!-- Price Per Day -->
                    <div class="row">
                        <div class="mb-3 col-md-4">
                            <label for="pricePerDay" class="form-label">Price Per Hour (â‚¹):</label>
                            <input type="number" id="pricePerDay" name="pricePerDay" value="<%= vehicle.pricePerDay %>" required class="form-control">
                            <div class="invalid-feedback">Please provide a valid price.</div>
                        </div>

                        <!-- Location -->
                        <div class="mb-3 col-md-8">
                            <label for="location" class="form-label">Location:</label>
                            <input type="text" id="location" name="location" value="<%= vehicle.location %>" required class="form-control">
                            <div class="invalid-feedback">Please provide the location.</div>
                        </div>
                    </div>

                    <!-- Country -->
                    <div class="mb-3">
                        <label for="country" class="form-label">Country:</label>
                        <input type="text" id="country" name="country" value="<%= vehicle.country %>" required class="form-control">
                        <div class="invalid-feedback">Please provide the country name.</div>
                    </div>

                    <!-- Features -->
                    <div class="mb-3">
                        <label for="features" class="form-label">Features (comma-separated):</label>
                        <input type="text" id="features" name="features" value="<%= vehicle.features.join(', ') %>" class="form-control">
                    </div>

                    <!-- Availability -->
                    <div class="mb-3">
                        <label for="availability" class="form-label">Availability:</label>
                        <select name="availability" id="availability" class="form-control" required>
                            <option value="true" <%= vehicle.availability ? 'selected' : '' %>>Available</option>
                            <option value="false" <%= !vehicle.availability ? 'selected' : '' %>>Unavailable</option>
                        </select>
                    </div>

                    <!-- Rating -->
                    <div class="mb-3">
                        <label for="rating" class="form-label">Rating (0-5):</label>
                        <input type="number" id="rating" name="rating" step="0.1" min="0" max="5" value="<%= vehicle.rating %>" class="form-control">
                    </div>

                    <!-- Submit Button -->
                    <button type="submit" class="btn btn-dark edit-btn mt-3">Update Vehicle</button>
                    <br><br>
                </div>
            </div>
        </form>
    </div>
</body>
